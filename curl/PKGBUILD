pkgbase=curl
pkgname=('curl-doc' 'curl-dev' 'libcurl' 'curl')
pkgver=7.57.0.r124.g9d82cde7b
pkgrel=1
pkgdesc="An URL retrival utility and library"
url="https://curl.haxx.se/"
arch=('x86_64')
license=('MIT')
depends_doc=()
depends_dev=('libcurl')
depends_lib=('ca-certificates' 'zlib')
depends=('libcurl')
makedepends=('libressl-dev')
source=('git://github.com/curl/curl.git')
sha256sums=('SKIP')

pkgver() {
  cd "$pkgbase"
  
  git describe --long --tags | sed 's/^curl-//;s/\([^-]*-g\)/r\1/;s/[_-]/./g'
}

build() {
  cd "$pkgbase"
  
  ./buildconf
  ./configure --prefix=/usr \
              --enable-ipv6 \
              --enable-unix-sockets \
              --without-libidn \
              --without-libidn2 \
              --disable-static \
              --disable-ldap \
              --with-pic

  make
}

package(){
  package-init
  
  cd "$pkgbase"
  
  make DESTDIR="$tmpdir" install
}

package_curl-doc() {
  package-doc
}

package_curl-dev() {
  package-dev
}

package_libcurl() {
  package-lib
}

package_curl() {
  package-base
}
