# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgbase=fakeroot
pkgname=('fakeroot-doc' 'fakeroot')
pkgver=1.21.3.1
pkgrel=1
pkgdesc="Gives a fake root environment, useful for building packages as a non-privileged user"
arch=('x86_64')
license=('GPL')
url="http://fakeroot.alioth.debian.org/"
depends_doc=()
depends=('musl')
makedepends=('libtool' 'autoconf' 'automake' 'po4a' 'libcap' 'acl' 'linux-headers')
source=(git://anonscm.debian.org/users/clint/fakeroot.git)
md5sums=('SKIP')

pkgver() {
  cd "$pkgbase"
  
  cd debian
  
  head -n 1 changelog | cut -d '(' -f 2 | cut -d ')' -f 1 | sed 's/^v//;s/\([^-]*-g\)/r\1/;s/[_-]/./g'
}

build() {
  cd "$pkgbase"
  
  export CFLAGS="-D_STAT_VER=0 $CFLAGS"
  ./bootstrap
  
  ./configure --prefix=/usr \
              --disable-static \
  
  make
  
  cd doc
  po4a -k 0 --rm-backups --variable "srcdir=../doc/" po4a/po4a.cfg
}


package() {
  package-init
  
  cd "$pkgbase"
  
  make DESTDIR="$tmpdir" install
}

package_fakeroot-doc() {
  package-doc
}

package_fakeroot() {
  groups=('base-devel')
  
  package-base
}
