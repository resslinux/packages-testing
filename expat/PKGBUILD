pkgrealname=libexpat
pkgbase=expat
pkgname=('expat-doc' 'expat-dev' 'expat' 'expat-tools')
pkgver=2.2.5.r34.gc55d52d
pkgrel=1
pkgdesc="An XML parser library"
url="https://libexpat.github.io/"
arch=('x86_64')
license=('custom')
depends_doc=()
depends_dev=('expat')
depends_lib=('musl')
depends=('expat')
makedepends=()
source=(git://github.com/libexpat/$pkgrealname.git)
sha256sums=('SKIP')

pkgver() {
  cd "$pkgrealname"
  
  git describe --long --tags | sed 's/^R_//;s/\([^-]*-g\)/r\1/;s/-/./g;s/_/./g'
}

build() {
  cd "$pkgrealname/$pkgbase"
  
  cmake -G 'Ninja' \
        -DCMAKE_BUILD_TYPE:STRING=Release \
        -DCMAKE_INSTALL_PREFIX:PATH=/usr \
        -DBUILD_doc:BOOL=ON
  
  ninja
}

package(){
  package-init
  
  cd "$pkgrealname/$pkgbase"
  
  DESTDIR="$tmpdir" ninja install
  
  mv "$tmpdir/usr/lib64" "$tmpdir/usr/lib"
}

package_expat-doc() {
  package-doc
}

package_expat-dev() {
  package-dev
}

package_expat() {
  package-lib
}

package_expat-tools() {
  package-base
}
